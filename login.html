<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Iniciar Sesión - Nexos</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="images/favicon.svg" type="image/svg+xml">
    <link rel="shortcut icon" href="images/favicon.svg" type="image/svg+xml">
    <style>
        .form-group { margin-bottom: 1.5rem; }
        .form-label { display: block; margin-bottom: 0.5rem; color: var(--dark); font-weight: 500; }
        .form-input { width: 100%; padding: 0.9rem; border: 2px solid #e0e0e0; border-radius: 10px; font-size: 1rem; transition: border-color 0.3s; }
        .form-input:focus { outline: none; border-color: var(--primary); }
        .btn-primary { width: 100%; padding: 1rem; font-size: 1.1rem; background: var(--secondary); color: white; border: none; border-radius: 50px; font-weight: 600; cursor: pointer; transition: all 0.3s; }
        .btn-primary:hover { transform: translateY(-3px); box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1); }
        .btn-type { padding: 1rem 2.5rem; border: 2px solid var(--primary); border-radius: 50px; font-size: 1.1rem; font-weight: 600; cursor: pointer; transition: all 0.3s; min-width: 200px; }
        .btn-type.active { background: var(--primary); color: white; }
        .btn-type:not(.active) { background: white; color: var(--primary); }
        .tab-button { flex: 1; padding: 1rem; background: none; border: none; border-bottom: 3px solid transparent; color: #666; font-weight: 600; cursor: pointer; transition: all 0.3s; }
        .tab-button.active { border-bottom-color: var(--primary); color: var(--primary); }
        .alert { padding: 1rem; border-radius: 10px; margin-bottom: 1rem; display: none; }
        .alert.success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .alert.error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
    </style>
</head>
<body>
    <header>
        <nav class="navbar">
            <a href="index.html" class="logo">
                <i class="fas fa-heart"></i>
                <span>Nexos</span>
            </a>
            <ul class="nav-links">
                <li><a href="index.html">Inicio</a></li>
                <li><a href="subastas.html">Subastas</a></li>
                <li><a href="causas.html">Causas</a></li>
                <li><a href="empresas.html">Empresas</a></li>
                <li><a href="contacto.html">Contacto</a></li>
            </ul>
            <button class="cta-button" onclick="window.location.href='login.html'">Iniciar Sesión</button>
        </nav>
    </header>

    <section class="trending-section" style="padding: 4rem 5%; min-height: calc(100vh - 200px);">
        <h2 class="section-title">Bienvenido a Nexos</h2>
        <p style="text-align: center; color: #666; margin-bottom: 3rem; font-size: 1.1rem;">Selecciona tu tipo de cuenta para continuar</p>

        <div style="display: flex; justify-content: center; gap: 2rem; margin-bottom: 3rem; flex-wrap: wrap;">
            <button class="btn-type active" id="btnUsuario" onclick="cambiarTipo('usuario')">
                <i class="fas fa-user" style="margin-right: 0.5rem;"></i>Usuario
            </button>
            <button class="btn-type" id="btnEmpresa" onclick="cambiarTipo('empresa')">
                <i class="fas fa-building" style="margin-right: 0.5rem;"></i>Empresa
            </button>
        </div>

        <div style="max-width: 500px; margin: 0 auto;">
            <div id="formUsuario" style="background: white; padding: 3rem; border-radius: 20px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);">
                <h3 style="color: var(--primary); text-align: center; margin-bottom: 2rem; font-size: 1.8rem;">
                    <i class="fas fa-user" style="margin-right: 0.5rem;"></i>Cuenta de Usuario
                </h3>

                <div style="display: flex; margin-bottom: 2rem; border-bottom: 2px solid #e0e0e0;">
                    <button class="tab-button active" id="tabLoginUsuario" onclick="cambiarTab('usuario', 'login')">Iniciar Sesión</button>
                    <button class="tab-button" id="tabRegistroUsuario" onclick="cambiarTab('usuario', 'registro')">Registrarse</button>
                </div>

                <div id="alertUsuario" class="alert"></div>

                <form id="loginUsuarioForm" onsubmit="loginUsuario(event)">
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-user" style="margin-right: 0.5rem; color: var(--primary);"></i>Usuario</label>
                        <input type="text" name="username" class="form-input" required placeholder="Ingresa tu usuario">
                    </div>
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-lock" style="margin-right: 0.5rem; color: var(--primary);"></i>Contraseña</label>
                        <input type="password" name="password" class="form-input" required placeholder="Ingresa tu contraseña">
                    </div>
                    <button type="submit" class="btn-primary"><i class="fas fa-sign-in-alt" style="margin-right: 0.5rem;"></i>Iniciar Sesión</button>
                </form>

                <form id="registroUsuarioForm" onsubmit="registrarUsuario(event)" style="display: none;">
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-user" style="margin-right: 0.5rem; color: var(--primary);"></i>Usuario *</label>
                        <input type="text" name="username" class="form-input" required placeholder="Elige un nombre de usuario">
                    </div>
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-id-badge" style="margin-right: 0.5rem; color: var(--primary);"></i>Nombre *</label>
                        <input type="text" name="nombre" class="form-input" required placeholder="Tu nombre">
                    </div>
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-id-badge" style="margin-right: 0.5rem; color: var(--primary);"></i>Apellido *</label>
                        <input type="text" name="apellido" class="form-input" required placeholder="Tu apellido">
                    </div>
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-envelope" style="margin-right: 0.5rem; color: var(--primary);"></i>Correo Electrónico *</label>
                        <input type="email" name="email" class="form-input" required placeholder="tu@email.com">
                    </div>
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-phone" style="margin-right: 0.5rem; color: var(--primary);"></i>Teléfono</label>
                        <input type="tel" name="telefono" class="form-input" placeholder="+56 9 1234 5678">
                    </div>
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-lock" style="margin-right: 0.5rem; color: var(--primary);"></i>Contraseña *</label>
                        <input type="password" name="password" class="form-input" required placeholder="Crea una contraseña">
                    </div>
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-lock" style="margin-right: 0.5rem; color: var(--primary);"></i>Confirmar Contraseña *</label>
                        <input type="password" name="password2" class="form-input" required placeholder="Confirma tu contraseña">
                    </div>
                    <button type="submit" class="btn-primary"><i class="fas fa-user-plus" style="margin-right: 0.5rem;"></i>Registrarse</button>
                </form>
            </div>

            <div id="formEmpresa" style="background: white; padding: 3rem; border-radius: 20px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1); display: none;">
                <h3 style="color: var(--primary); text-align: center; margin-bottom: 2rem; font-size: 1.8rem;">
                    <i class="fas fa-building" style="margin-right: 0.5rem;"></i>Cuenta de Empresa
                </h3>

                <div style="display: flex; margin-bottom: 2rem; border-bottom: 2px solid #e0e0e0;">
                    <button class="tab-button active" id="tabLoginEmpresa" onclick="cambiarTab('empresa', 'login')">Iniciar Sesión</button>
                    <button class="tab-button" id="tabRegistroEmpresa" onclick="cambiarTab('empresa', 'registro')">Registrarse</button>
                </div>

                <div id="alertEmpresa" class="alert"></div>

                <form id="loginEmpresaForm" onsubmit="loginEmpresa(event)">
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-user" style="margin-right: 0.5rem; color: var(--primary);"></i>Usuario</label>
                        <input type="text" name="username" class="form-input" required placeholder="Ingresa tu usuario">
                    </div>
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-lock" style="margin-right: 0.5rem; color: var(--primary);"></i>Contraseña</label>
                        <input type="password" name="password" class="form-input" required placeholder="Ingresa tu contraseña">
                    </div>
                    <button type="submit" class="btn-primary"><i class="fas fa-sign-in-alt" style="margin-right: 0.5rem;"></i>Iniciar Sesión</button>
                </form>

                <form id="registroEmpresaForm" onsubmit="registrarEmpresa(event)" style="display: none;">
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-user" style="margin-right: 0.5rem; color: var(--primary);"></i>Usuario *</label>
                        <input type="text" name="username" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-building" style="margin-right: 0.5rem; color: var(--primary);"></i>Razón Social *</label>
                        <input type="text" name="razonSocial" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-id-card" style="margin-right: 0.5rem; color: var(--primary);"></i>RUT *</label>
                        <input type="text" name="rut" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-envelope" style="margin-right: 0.5rem; color: var(--primary);"></i>Correo *</label>
                        <input type="email" name="email" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-phone" style="margin-right: 0.5rem; color: var(--primary);"></i>Teléfono</label>
                        <input type="tel" name="telefono" class="form-input">
                    </div>
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-map-marker-alt" style="margin-right: 0.5rem; color: var(--primary);"></i>Dirección</label>
                        <input type="text" name="direccion" class="form-input">
                    </div>
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-globe" style="margin-right: 0.5rem; color: var(--primary);"></i>Sitio Web</label>
                        <input type="url" name="sitioWeb" class="form-input">
                    </div>
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-lock" style="margin-right: 0.5rem; color: var(--primary);"></i>Contraseña *</label>
                        <input type="password" name="password" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-lock" style="margin-right: 0.5rem; color: var(--primary);"></i>Confirmar *</label>
                        <input type="password" name="password2" class="form-input" required>
                    </div>
                    <button type="submit" class="btn-primary"><i class="fas fa-building" style="margin-right: 0.5rem;"></i>Registrar Empresa</button>
                </form>
            </div>
        </div>
    </section>

    <footer>
        <div class="footer-content">
            <div class="logo"><i class="fas fa-heart"></i><span>Nexos</span></div>
            <p>Conectando empresas con causas que transforman vidas</p>
            <div class="social-links">
                <a href="#"><i class="fab fa-facebook"></i></a>
                <a href="#"><i class="fab fa-twitter"></i></a>
                <a href="#"><i class="fab fa-instagram"></i></a>
                <a href="#"><i class="fab fa-linkedin"></i></a>
            </div>
            <p class="copyright">© 2025 Nexos. Todos los derechos reservados.</p>
        </div>
    </footer>

    <script src="auth.js"></script>
    <script>
        if (auth.isLoggedIn()) {
            window.location.href = 'index.html';
        }

        function cambiarTipo(tipo) {
            document.getElementById('btnUsuario').classList.toggle('active', tipo === 'usuario');
            document.getElementById('btnEmpresa').classList.toggle('active', tipo === 'empresa');
            document.getElementById('formUsuario').style.display = tipo === 'usuario' ? 'block' : 'none';
            document.getElementById('formEmpresa').style.display = tipo === 'empresa' ? 'block' : 'none';
        }

        function cambiarTab(tipo, modo) {
            const prefix = tipo === 'usuario' ? 'Usuario' : 'Empresa';
            document.getElementById('tabLogin' + prefix).classList.toggle('active', modo === 'login');
            document.getElementById('tabRegistro' + prefix).classList.toggle('active', modo === 'registro');
            document.getElementById('login' + prefix + 'Form').style.display = modo === 'login' ? 'block' : 'none';
            document.getElementById('registro' + prefix + 'Form').style.display = modo === 'registro' ? 'block' : 'none';
            document.getElementById('alert' + prefix).style.display = 'none';
        }

        function mostrarAlerta(tipo, mensaje, esError = false) {
            const alert = document.getElementById('alert' + tipo);
            alert.textContent = mensaje;
            alert.className = 'alert ' + (esError ? 'error' : 'success');
            alert.style.display = 'block';
            setTimeout(function() { alert.style.display = 'none'; }, 5000);
        }

        function loginUsuario(e) {
            e.preventDefault();
            const form = e.target;
            const result = auth.login(form.username.value, form.password.value, 'user');
            if (result.success) {
                mostrarAlerta('Usuario', result.message, false);
                setTimeout(function() { window.location.href = 'index.html'; }, 1000);
            } else {
                mostrarAlerta('Usuario', result.message, true);
            }
        }

        function loginEmpresa(e) {
            e.preventDefault();
            const form = e.target;
            const result = auth.login(form.username.value, form.password.value, 'empresa');
            if (result.success) {
                mostrarAlerta('Empresa', result.message, false);
                setTimeout(function() { window.location.href = 'index.html'; }, 1000);
            } else {
                mostrarAlerta('Empresa', result.message, true);
            }
        }

        function registrarUsuario(e) {
            e.preventDefault();
            const form = e.target;
            if (form.password.value !== form.password2.value) {
                mostrarAlerta('Usuario', 'Las contraseñas no coinciden', true);
                return;
            }
            const result = auth.registerUser({
                username: form.username.value,
                nombre: form.nombre.value,
                apellido: form.apellido.value,
                email: form.email.value,
                telefono: form.telefono.value,
                password: form.password.value
            });
            if (result.success) {
                mostrarAlerta('Usuario', result.message, false);
                form.reset();
                setTimeout(function() { cambiarTab('usuario', 'login'); }, 2000);
            } else {
                mostrarAlerta('Usuario', result.message, true);
            }
        }

        function registrarEmpresa(e) {
            e.preventDefault();
            const form = e.target;
            if (form.password.value !== form.password2.value) {
                mostrarAlerta('Empresa', 'Las contraseñas no coinciden', true);
                return;
            }
            const result = auth.registerEmpresa({
                username: form.username.value,
                razonSocial: form.razonSocial.value,
                rut: form.rut.value,
                email: form.email.value,
                telefono: form.telefono.value,
                direccion: form.direccion.value,
                sitioWeb: form.sitioWeb.value,
                password: form.password.value
            });
            if (result.success) {
                mostrarAlerta('Empresa', result.message, false);
                form.reset();
                setTimeout(function() { cambiarTab('empresa', 'login'); }, 2000);
            } else {
                mostrarAlerta('Empresa', result.message, true);
            }
        }
    </script>
</body>
</html>
